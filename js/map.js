function getValue(key) {

	return parseInt(Math.random() * 1500);
}
var mapChart = echarts.init(document.getElementById("map"));

function formattedData(dataTable, index) {
	let size = dataTable.length - 1
	let formatted = Array(length);
	for (let i = 0; i < size; i++) {
		formatted[i] = {
			"name": dataTable[i + 1][0],
			"value": dataTable[i + 1][index + 1]
		}
	}
	return formatted;
}

function maxValue(dataTable){
	let length = dataTable.length - 1
	let width = dataTable[0].length - 1
	let max = 0.0;
	for(let i = 0;i < length;i++){
		for(let j = 0;j < width;j++){
			if(max < dataTable[i + 1][j + 1]){
				max = dataTable[i + 1][j + 1];
			}
		}
	}
	return max
}

var mask_data = [
	["province","2020.1.21-2020.1.31","2020.2.1-2020.2.10",	"2020.2.11-2020.2.20",	"2020.2.21-2020.3.29",	"2020.3.1-2020.3.10",	"2020.3.11-2020.3.20",	"2020.3.21-2020.3.31",	"2020.4.1-2020.4.10",	"2020.4.11-2020.4.20",	"2020.4.21-2020.4.30",	"2020.5.1-2020.5.10",	"2020.5.11-2020.5.20",	"2020.5.21-2020.5.31"],
	["北京",45730,40330,29730,24110,18400,15460,12360,11290,7840,6810,4560,5260,4480],
	["天津",14440,12470,10510,9060,6750,5150,3890,3640,2920,2620,2080,2400,2070],
	["上海",39360,28740,22030,18940,16280,15180,11370,10230,7250,6050,4180,5210,4000],
	["重庆",33790,18470,12630,11810,9300,6360,4790,4470,4160,3960,2890,2780,2400],
	["河北",44890,26660,19780,23310,14730,11270,9350,10110,8400,6670,4330,5700,4690],
	["山西",23410,14160,11320,11160,9870,7490,4900,4210,3510,3180,2770,3210,2570],
	["辽宁",30490,22240,16300,13350,11830,9130,6420,6000,4800,3980,2840,3910,2980],
	["吉林",17140,12150,10160,10060,7260,4920,3740,3430,2860,2600,2060,3000,2150],
	["黑龙江",21060,12970,10530,9400,8320,7220,4580,4470,4160,3290,2260,2460,2170],
	["江苏",69480,46820,32830,28540,23250,17490,15560,14700,9300,10300,7760,8840,6120],
	["浙江",61240,36450,21110,30650,23360,18570,15290,14160,12320,11400,8080,8550,5930],
	["安徽",35460,23460,14990,13050,11900,9670,8570,8530,6530,6130,4640,4210,2910],
	["福建",35150,27770,19840,15410,13810,12150,9460,8630,6070,5180,4190,4640,3600],
	["江西",29630,17170,12060,12210,10200,7160,5570,5400,3870,3600,3260,3790,2550],
	["山东",62920,42260,33320,32770,21200,14600,12300,11480,9870,8450,5590,7340,6560],
	["河南",44890,26600,21070,29880,18660,13030,10740,10530,8340,6880,5930,5770,3810],
	["湖北",38270,14290,12000,11490,11210,11030,10400,10320,7460,6400,4580,5110,4040],
	["湖南",40380,26700,20590,14580,11610,8220,6640,6780,6430,4930,3360,2920,2390],
	["广东",113960,96810,65270,50650,38760,30820,24440,21680,16780,14570,11400,112930,10190],
	["四川",70080,44480,28510,24740,16250,12010,10030,10420,8050,6190,4810,4430,3710],
	["贵州",16370,12480,10130,10020,7840,5490,3410,3330,2550,2500,2040,2040,2080],
	["云南",19160,12980,11250,10340,7330,5920,4680,3570,2840,2780,2470,2420,1990],
	["海南",10380,8530,6050,4560,3970,3320,2350,2320,2160,1770,1380,1400,1190],
	["陕西",23950,16410,12070,11680,10720,7770,5980,5100,4290,3740,2560,2790,2310],
	["甘肃",11590,10210,7180,8940,5680,3820,2670,2800,2860,2420,1040,1710,1310],
	["青海",4670,3350,2500,2700,2380,1950,1580,1470,1130,1120,800,880,820],
	["广西",22720,17880,12800,11850,9730,7300,4700,4390,3440,3290,3070,2710,2200],
	["内蒙古",13600,10720,8190,7610,5990,4490,3400,2950,2370,2490,2030,2010,1850],
	["西藏",2230,1660,1500,1030,1310,1350,1180,980,820,870,710,650,670],
	["宁夏",5940,3910,2940,3120,2610,2040,1800,1580,1140,1170,790,1100,1140],
	["新疆",10080,5770,3740,3650,3640,3770,2920,2860,2370,2080,1810,2100,1660],
	["香港",4900,3820,2670,2130,1890,1990,1810,1650,1340,1330,950,1190,910],
	["澳门",1740,1270,1210,1180,1040,960,710,710,650,640,570,520,520],
	["台湾",2900,2310,1720,1530,1550,1420,1290,1480,1060,1060,770,670,690]
];
var lock_down_data = [
	["province","2020.1.21-2020.1.31","2020.2.1-2020.2.10",	"2020.2.11-2020.2.20",	"2020.2.21-2020.3.29",	"2020.3.1-2020.3.10",	"2020.3.11-2020.3.20",	"2020.3.21-2020.3.31",	"2020.4.1-2020.4.10",	"2020.4.11-2020.4.20",	"2020.4.21-2020.4.30",	"2020.5.1-2020.5.10",	"2020.5.11-2020.5.20",	"2020.5.21-2020.5.31"],
	["北京",3260.00 ,7450.00 ,4710.00 ,2430.00 ,2050.00 ,2040.00 ,1910.00 ,1800.00 ,1800.00 ,1760.00 ,1300.00 ,1700.00 ,1530.00 ,1104.00],
	["天津",1590.00 ,3700.00 ,2060.00 ,1350.00 ,1240.00 ,1270.00 ,1210.00 ,1210.00 ,1160.00 ,1060.00 ,600.00 ,1070.00 ,960.00 ,896.00],
	["上海",3410.00 ,6530.00 ,5240.00 ,2090.00 ,1840.00 ,1800.00 ,1940.00 ,1740.00 ,1610.00 ,1570.00 ,1270.00 ,1630.00 ,1570.00 ,1080.00],
	["重庆",2060.00 ,4700.00 ,2250.00 ,1460.00 ,1330.00 ,1250.00 ,1270.00 ,1390.00 ,120.00 ,1270.00 ,790.00 ,1310.00 ,1290.00 ,760.00],
	["河北",2290.00 ,6590.00 ,3550.00 ,2120.00 ,1760.00 ,1650.00 ,1570.00 ,1480.00 ,1970.00 ,2010.00 ,1110.00 ,1540.00 ,1380.00 ,960.00],
	["山西",1850.00 ,4220.00 ,2280.00 ,1420.00 ,1380.00 ,1390.00 ,1300.00 ,1290.00 ,1310.00 ,1550.00 ,890.00 ,1100.00 ,1140.00 ,608.00],
	["辽宁",2140.00 ,6530.00 ,3200.00 ,1700.00 ,1450.00 ,1420.00 ,1420.00 ,1520.00 ,1480.00 ,1430.00 ,1140.00 ,1190.00 ,1310.00 ,824.00],
	["吉林",1200.00 ,4850.00 ,2260.00 ,1390.00 ,1120.00 ,1170.00 ,1020.00 ,1230.00 ,1190.00 ,1280.00 ,900.00 ,1360.00 ,1220.00 ,552.00],
	["黑龙江",1560.00 ,5910.00 ,3230.00 ,2020.00 ,1450.00 ,1230.00 ,1300.00 ,1200.00 ,1460.00 ,1950.00 ,530.00 ,1050.00 ,910.00 ,704.00],
	["江苏",4200.00 ,11170.00 ,5670.00 ,2530.00 ,2200.00 ,2110.00 ,1990.00 ,1950.00 ,2030.00 ,1980.00 ,1350.00 ,2070.00 ,1990.00 ,1160.00],
	["浙江",3530.00 ,9080.00 ,5970.00 ,2400.00 ,2070.00 ,2010.00 ,1950.00 ,1940.00 ,1860.00 ,1850.00 ,1400.00 ,1880.00 ,1720.00 ,1194.00],
	["安徽",2270.00 ,6650.00 ,3700.00 ,1730.00 ,1510.00 ,1430.00 ,1330.00 ,1390.00 ,1370.00 ,1290.00 ,1020.00 ,1430.00 ,1400.00 ,720.00],
	["福建",2220.00 ,5800.00 ,3660.00 ,1700.00 ,1580.00 ,1560.00 ,1570.00 ,1420.00 ,1420.00 ,1410.00 ,1250.00 ,1540.00 ,1510.00 ,960.00],
	["江西",2180.00 ,5490.00 ,3010.00 ,1590.00 ,1400.00 ,1480.00 ,1300.00 ,1260.00 ,1040.00 ,1170.00 ,1060.00 ,1350.00 ,1100.00 ,816.00] ,
[	"山东",2990.00 ,9170.00 ,4450.00 ,2400.00 ,2020.00 ,1820.00 ,1780.00 ,1870.00 ,2020.00 ,2140.00 ,1410.00 ,1820.00 ,1710.00 ,1176.00] ,
	["河南",2690.00 ,9470.00 ,3480.00 ,2070.00 ,1830.00 ,1770.00 ,1680.00 ,1630.00 ,1510.00 ,1610.00 ,1270.00 ,1610.00 ,1530.00 ,1048.00] ,
	["湖北",11870.00 ,11260.00 ,4960.00 ,3340.00 ,3000.00 ,3000.00 ,2540.00 ,2150.00 ,2140.00 ,1850.00 ,1580.00 ,1830.00 ,1650.00 ,1136.00] ,
	["湖南",2510.00 ,7600.00 ,3010.00 ,1820.00 ,1610.00 ,1500.00 ,1350.00 ,1430.00 ,1390.00 ,1500.00 ,990.00 ,1440.00 ,1340.00 ,888.00],
	["广东",7550.00 ,22850.00 ,8060.00 ,3380.00 ,3010.00 ,2890.00 ,3060.00 ,2690.00 ,2480.00 ,2380.00 ,1630.00 ,2670.00 ,2470.00 ,1400.00 ],
	["四川",3220.00 ,9020.00 ,4580.00 ,2090.00 ,1800.00 ,1760.00 ,1690.00 ,1680.00 ,1670.00 ,1690.00 ,1290.00 ,2080.00 ,2020.00 ,1144.00 ],
	["贵州",1150.00 ,4060.00 ,1890.00 ,1160.00 ,1200.00 ,1070.00 ,1130.00 ,1020.00 ,1160.00 ,1050.00 ,770.00 ,1060.00 ,1000.00 ,752.00 ],
	["云南",1250.00 ,4630.00 ,1930.00 ,1220.00 ,1130.00 ,1160.00 ,1180.00 ,1110.00 ,1050.00 ,1040.00 ,780.00 ,990.00 ,1150.00 ,723.00] ,
	["海南",770.00 ,2350.00 ,1370.00 ,1060.00 ,960.00 ,870.00 ,710.00 ,650.00 ,770.00 ,610.00 ,390.00 ,490.00 ,590.00 ,352.00] ,
	["陕西",1970.00 ,4430.00 ,2570.00 ,1580.00 ,1450.00 ,1320.00 ,1370.00 ,1390.00 ,1370.00 ,1400.00 ,860.00 ,1030.00 ,1230.00 ,712.00 ],
	["甘肃",880.00 ,2770.00 ,1490.00 ,1130.00 ,960.00 ,1000.00 ,960.00 ,790.00 ,750.00 ,770.00 ,650.00 ,720.00 ,820.00 ,288.00 ],
	["青海",290.00 ,1250.00 ,840.00 ,540.00 ,340.00 ,350.00 ,230.00 ,350.00 ,290.00 ,350.00 ,170.00 ,180.00 ,460.00 ,0.00 ],
	["广西",1970.00 ,4640.00 ,2430.00 ,1460.00 ,1380.00 ,1320.00 ,1390.00 ,1360.00 ,1200.00 ,1170.00 ,970.00 ,1110.00 ,1290.00 ,848.00 ],
	["内蒙古",960.00 ,3600.00 ,1800.00 ,1260.00 ,1000.00 ,1110.00 ,1080.00 ,1120.00 ,1040.00 ,1340.00 ,710.00 ,720.00 ,830.00 ,416.00 ],
	["西藏",130.00 ,700.00 ,470.00 ,50.00 ,110.00 ,340.00 ,170.00 ,110.00 ,170.00 ,60.00 ,50.00 ,170.00 ,50.00 ,56.00 ],
	["宁夏",390.00 ,1170.00 ,940.00 ,490.00 ,750.00 ,590.00 ,300.00 ,520.00 ,660.00 ,650.00 ,340.00 ,300.00 ,400.00 ,112.00 ],
	["新疆",590.00 ,2430.00 ,1470.00 ,1200.00 ,960.00 ,1030.00 ,780.00 ,1160.00 ,1020.00 ,840.00 ,520.00 ,860.00 ,800.00 ,464.00 ],
	["香港",600.00 ,2110.00 ,1950.00 ,880.00 ,630.00 ,580.00 ,820.00 ,690.00 ,400.00 ,230.00 ,110.00 ,410.00 ,400.00 ,112.00 ],
	["澳门",270.00 ,680.00 ,590.00 ,340.00 ,170.00 ,110.00 ,50.00 ,110.00 ,0.00 ,0.00 ,0.00 ,0.00 ,0.00 ,0.00 ],
	["台湾",870.00 ,2730.00 ,5650.00 ,1310.00 ,960.00 ,1000.00 ,640.00 ,940.00 ,640.00 ,820.00 ,290.00 ,460.00 ,300.00 ,112.00 ]
];

setOption("口罩",mask_data);
function setOption(title,dataTable) {
	var option = {
		baseOption: {
			title: {
			    text: '"' + title +'"'+ "热度地图",
				subtext: "数据来自百度指数",
				sublink:"http://index.baidu.com/v2/index.html#/",
			    left: "left",
			    top: "top",
			    textStyle: {
			      fontSize: 15,
				  color:"#fff"
			    },
			},
			toolbox: {
		            show: true,
		            orient: 'horizontal',
		            left: 'right',
		            top: 'top',
					itemSize: 20,
		            feature: {
						myMask:{
							title:"口罩热度指数",
							show:true,
							icon:"path://M532.693333 133.162667l331.008 82.773333c18.986667 4.693333 32.298667 21.76 32.298667 41.386667V298.666667h42.666667c46.933333 0 85.333333 38.4 85.333333 85.333333v128a128 128 0 0 1-128 128h-17.962667a256.042667 256.042667 0 0 1-123.562666 134.741333l-204.330667 102.186667a85.418667 85.418667 0 0 1-76.288 0l-204.373333-102.186667A256.213333 256.213333 0 0 1 146.005333 640H128a128 128 0 0 1-128-128V384a85.333333 85.333333 0 0 1 85.333333-85.333333h42.666667v-41.386667c0-19.541333 13.312-36.608 32.298667-41.386667l331.008-82.730666c13.568-3.413333 27.818667-3.413333 41.386666 0zM512 215.936l-298.666667 74.666667v255.146666c0 64.682667 36.522667 123.733333 94.336 152.704L512 800.597333l204.330667-102.144A170.709333 170.709333 0 0 0 810.666667 545.792v-255.146667l-298.666667-74.666666zM128 384H85.333333v128a42.666667 42.666667 0 0 0 42.666667 42.666667V384z m810.666667 0h-42.666667v170.666667a42.666667 42.666667 0 0 0 42.666667-42.666667V384z",
							onclick:function(){
								setOption("口罩",mask_data);
							}
						},
						myLock:{
							title:"封城热度指数",
							show:true,
							icon:"path://M243.641379 377.82069a35.310345 35.310345 0 0 1 46.574345 3.672276l2.860138 3.389793 84.744828 112.993103a35.310345 35.310345 0 0 1-53.636414 45.762207L321.324138 540.248276l-84.744828-112.993104a35.310345 35.310345 0 0 1 7.062069-49.434482zM437.848276 377.82069a35.310345 35.310345 0 0 1 46.574345 3.672276l2.860138 3.389793 84.744827 112.993103a35.310345 35.310345 0 0 1-53.636414 45.762207L515.531034 540.248276l-84.744827-112.993104a35.310345 35.310345 0 0 1 7.062069-49.434482zM632.055172 377.82069a35.310345 35.310345 0 0 1 46.574345 3.672276l2.860138 3.389793 84.744828 112.993103a35.310345 35.310345 0 0 1-53.636414 45.762207L709.737931 540.248276l-84.744828-112.993104a35.310345 35.310345 0 0 1 7.062069-49.434482zM547.310345 110.344828v203.034482h-70.62069v-203.034482zM370.758621 110.344828v203.034482h-70.62069v-203.034482zM723.862069 110.344828v203.034482h-70.62069v-203.034482zM884.347586 583.71531v70.62069H139.652414v-70.62069z" ,
							onclick:function(){
								setOption("封城",lock_down_data)
							}
						},
						saveAsImage: {},
		            }
		        },
			timeline: {
				axisType: 'category',
				show: true,
				autoPlay:true,
				label:{
					color:"#fff"
				},
				data: [
					"2020.1.21-2020.1.31", "2020.2.1-2020.2.10", "2020.2.11-2020.2.20", "2020.2.21-2020.3.29", "2020.3.1-2020.3.10",
					"2020.3.11-2020.3.20", "2020.3.21-2020.3.31", "2020.4.1-2020.4.10", "2020.4.11-2020.4.20", "2020.4.21-2020.4.30",
					"2020.5.1-2020.5.10", "2020.5.11-2020.5.20", "2020.5.21-2020.5.31"
				]
			},
			tooltip: {
				show: true
			},
			visualMap: {
				min: 0,
				max: maxValue(dataTable) * 3 / 5,
				left: 'left',
				top: 'bottom',
				text: ['高', '低'],
				textStyle: {
					color: "#fff"
				},
				show: true,
			},
			
			geo: {
				show: true,
				map: 'china',
				label: {
					normal: {
						show: false,
						fontSize: '10',
					}
				},
				emphasis: {
					itemStyle: {
						shadowBlur: 3,
						shadowColor: 'rgba(0, 0, 0, 0.5)',
					}
				}
			},
		},
		options: [{
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 0)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 1)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 2)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 3)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 4)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 5)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 6)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 7)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 8)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 9)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 10)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 11)
				}
			}, {
				series: {
					name: '热度',
					type: 'map',
					geoIndex: 0,
					data: formattedData(dataTable, 12)
				}
			}

		]
	};
	mapChart.setOption(option,{notMerge:true});
}
